---
title: "brandon_scratch"
author: "Brandon Mannion"
date: "11/27/2018"
output: html_document
---

# PSEUDO / MISC.
- implement tangent (derivative-based) adaptive rejection sampler
- INPUTS: sample number
- check density
- check log concave density
- generate enveloping function
- squeezing function
- from sample number, do loop
  - etc. etc. 

## initial error-checking
- check input domain, D
- check input k, the number of xs to derive tangent
- check input g(x) , it's log form, log-concave, differentiable, etc.
- check input n, the number of values to sample

# CODE

## load libraries
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(assertthat)
library(numDeriv)
```
  
## dummy variables
```{r}
# borrowed setup from vaibhav_scratch.R
x <- -3:3

h <- function(x) {
  return(2*x - 10*log(1 + exp(x)) - 0.5*x^2 + 50)
}

#z <- seq(-2.5, 2.5, by = 1)
#D <- c(-5, 4)
```

## FUNCTION for intersection of tangent lines for x_{j} and x_{j+1}
```{r}
get_z  <- function(x_initial, x_next, h) {
        
    # XXX assert_that(is.numeric(x_initial), msg = "starting x is not a number and/or within D")
    # XXX assert_that(is.numeric(x_next), msg = "next x is not a number and/or within D")

        
        # log_concave_density will already be past initial error-checking
        # assert_that ... ? 
        
        # EQUATION 1
        # z_{j} = h(x_{j+1}) - h(x_j) - x_{j+1} h'(x_{j+1}) + x_j h'(x_j)
        # ....... -----------------------------------------------------
        # .......                h'(x_j) - h'(x_{j+1})
        # END EQUATION 1

         # get h(x[j]) and h'(x[j])
        h_xj <- h(x_initial)
        h_prime_xj <- grad(h,x_initial)
        
        h_xjnext <- h(x_next)
        h_prime_xjnext <- grad(h, x_next)
  
        z_numerator <- h_xjnext - h_xj - ( x_next * h_prime_xjnext ) + (x_initial * h_prime_xj)
        z_denominator <- h_prime_xj - h_prime_xjnext
        return( z_numerator / z_denominator )
}
```